<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Stub.by : " />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Stub.by</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/mrak/stub.by">View on GitHub</a>

          <h1 id="project_title">Stub.by</h1>
          <h2 id="project_tagline"></h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/mrak/stub.by/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/mrak/stub.by/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="stubby" class="anchor" href="#stubby"><span class="octicon octicon-link"></span></a>Stubby</h1>

<pre><code>a small web server for stubbing external systems during development
</code></pre>

<h5>
<a name="why-the-word-stubby" class="anchor" href="#why-the-word-stubby"><span class="octicon octicon-link"></span></a>Why the word "stubby"?</h5>

<p>It is a stub HTTP server after all, hence the "stubby". Also, in Australian slang "stubby" means <em>beer bottle</em></p>

<h2>
<a name="table-of-contents" class="anchor" href="#table-of-contents"><span class="octicon octicon-link"></span></a>Table of Contents</h2>

<ul>
<li><a href="#versions-available">Versions Available</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#key-features">Key Features</a></li>
<li><a href="#why-would-a-developer-use-stubby">Why would a developer use stubby</a></li>
<li><a href="#why-would-a-qa-use-stubby">Why would a QA use stubby</a></li>
<li><a href="#command-line-switches">Command-line Switches</a></li>
<li>
<a href="#endpoint-configuration">Endpoint Configuration HOWTO</a>

<ul>
<li><a href="#request">Request</a></li>
<li><a href="#response">Response</a></li>
</ul>
</li>
<li><a href="#the-admin-portal">The Admin Portal</a></li>
<li><a href="#the-stubs-portal">The Stubs Portal</a></li>
<li><a href="#programmatic-apis">Programmatic APIs</a></li>
</ul><h2>
<a name="versions-available" class="anchor" href="#versions-available"><span class="octicon octicon-link"></span></a>Versions Available</h2>

<ul>
<li><a href="http://stub.by/4j">Java</a></li>
<li><a href="http://stub.by/4node">Nodejs</a></li>
<li><a href="http://stub.by/4net">.NET</a></li>
</ul><h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<h3>
<a name="java" class="anchor" href="#java"><span class="octicon octicon-link"></span></a>Java</h3>

<p>Available on <a href="http://search.maven.org/#search%7Cgav%7C1%7Cg%3A%22by.stub%22%20AND%20a%3A%22stubby4j%22">Maven Central</a></p>

<ul>
<li>
<strong>Group ID</strong> by.stub</li>
<li>
<strong>Artifact ID</strong> stubby4j</li>
</ul><h3>
<a name="node" class="anchor" href="#node"><span class="octicon octicon-link"></span></a>Node</h3>

<p>As a command-line tool</p>

<pre><code>npm install -g stubby
</code></pre>

<p>or as a module dependency</p>

<pre><code>npm install stubby
</code></pre>

<h3>
<a name="net" class="anchor" href="#net"><span class="octicon octicon-link"></span></a>.NET</h3>

<p>As a command-line: <a href="http://stub.by/downloads/4net">.NET Downloads</a></p>

<p>or as a project reference via NuGet</p>

<pre><code>PM&gt; Install-Package stubby
</code></pre>

<h2>
<a name="key-features" class="anchor" href="#key-features"><span class="octicon octicon-link"></span></a>Key Features</h2>

<ul>
<li>Emulates external webservices in a sandbox for your application to consume over HTTP(S)</li>
<li>HTTP request verification and HTTP response stubbing</li>
<li>Regex support for dynamic matching on URI, query params, headers, POST body (ie:. <code>mod_rewrite</code> in Apache)</li>
<li>Dynamic flows: Multiple stubbed responses on the same stubbed URI to test multiple application flows</li>
<li>Fault injection, where after X good responses on the same URI you get a bad one</li>
<li>Serve binary files as stubbed response content (images, PDFs. etc.)</li>
<li>Embed stubby to create a web service sandbox for your integration test suite</li>
</ul><h3>
<a name="incubating-features-experimental-or-not-present-in-all-versions" class="anchor" href="#incubating-features-experimental-or-not-present-in-all-versions"><span class="octicon octicon-link"></span></a>Incubating features (experimental or not present in all versions)</h3>

<ul>
<li>Dynamic token replacement in stubbed responses by leveraging regex capturing groups as token values during HTTP request verification</li>
<li>Record &amp; Replay. The HTTP response is recorded on the first call, having the subsequent calls play back the recorded HTTP response, without actually connecting to the external server</li>
</ul><h2>
<a name="why-would-a-developer-use-stubby" class="anchor" href="#why-would-a-developer-use-stubby"><span class="octicon octicon-link"></span></a>Why would a developer use stubby?</h2>

<h4>
<a name="you-want-to" class="anchor" href="#you-want-to"><span class="octicon octicon-link"></span></a>You want to:</h4>

<ul>
<li>Simulate responses from real server and don't care to (or cannot) go over the network</li>
<li>Stub third party web services that your application contacts which are not yet ready</li>
<li>Verify that your code makes HTTP requests with all the required parameters and/or headers</li>
<li>Verify that your code correctly handles HTTP error codes</li>
<li>Trigger a response from the server based on the request parameters over HTTP or HTTPS</li>
<li>Support any of the available HTTP methods</li>
<li>Simulate support for Basic Authentication</li>
<li>Support HTTP 30x redirects</li>
<li>Provide canned answers in your contract/integration tests</li>
<li>Enable delayed responses for performance and stability testing</li>
<li>Avoid to spend time coding for the above requirements</li>
<li>Concentrate on the task at hand</li>
</ul><h2>
<a name="why-would-a-qa-use-stubby" class="anchor" href="#why-would-a-qa-use-stubby"><span class="octicon octicon-link"></span></a>Why would a QA use stubby?</h2>

<h4>
<a name="you-want-to-1" class="anchor" href="#you-want-to-1"><span class="octicon octicon-link"></span></a>You want to:</h4>

<ul>
<li>Specify mock responses to simulate page conditions without real data</li>
<li>Test polling mechanisms by stubbing a sequence of responses for the same URI</li>
<li>Easily swap data config files to run different data sets and responses</li>
<li>Have an all-in-one stub server to handle mock data with less need to upkeep code for test generation</li>
</ul><h2>
<a name="command-line-switches" class="anchor" href="#command-line-switches"><span class="octicon octicon-link"></span></a>Command-line Switches</h2>

<pre><code>Standard switches:
 -a,--admin &lt;arg&gt;      Port for admin portal. Defaults to 8889.
 -d,--data &lt;arg&gt;       Data file to pre-load endoints. YAML or JSON format.
 -h,--help             This help text.
 -l,--location &lt;arg&gt;   Hostname at which to bind stubby.
 -m,--mute             Prevent stubby from printing to the console.
 -s,--stubs &lt;arg&gt;      Port for stub portal. Defaults to 8882.
 -t,--tls &lt;arg&gt;        Port for https stubs portal. Defaults to 7443.
 -w,--watch            Auto-reload data file when edits are made.
 -v,--version          Prints stubby's version number.

stubby4j switches:
 -p,--password &lt;arg&gt;   Password for the provided keystore file.
 -k,--keystore &lt;arg&gt;   Keystore file for custom SSL. By default SSL is
                       enabled using internal keystore.

stubby4node switches:
 -p,--pfx &lt;arg&gt;        PFX file. Ignored if used with --key/--cert
 -k,--key &lt;arg&gt;        Private key file. Use with --cert.
 -c,--cert &lt;arg&gt;       Certificate file. Use with --key.
</code></pre>

<h2>
<a name="endpoint-configuration" class="anchor" href="#endpoint-configuration"><span class="octicon octicon-link"></span></a>Endpoint Configuration</h2>

<p>This section explains the usage, intent and behavior of each property on the <code>request</code> and <code>response</code> objects.</p>

<p>Here is a fully-populated, unrealistic endpoint:</p>

<div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/your/awesome/endpoint$</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">POST</span>
    <span class="l-Scalar-Plain">query</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">exclamation</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">post requests can have query strings!</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/xml</span>
    <span class="l-Scalar-Plain">post</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
      <span class="no">&lt;!xml blah="blah blah blah"&gt;</span>
      <span class="no">&lt;envelope&gt;</span>
        <span class="no">&lt;unaryTag/&gt;</span>
      <span class="no">&lt;/envelope&gt;</span>
    <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tryMyFirst.xml</span>
  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">200</span>
    <span class="l-Scalar-Plain">latency</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">5000</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/xml</span>
      <span class="l-Scalar-Plain">server</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">stubbedServer/4.2</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
      <span class="no">&lt;!xml blah="blah blah blah"&gt;</span>
      <span class="no">&lt;responseXML&gt;</span>
        <span class="no">&lt;content&gt;&lt;/content&gt;</span>
      <span class="no">&lt;/responseXML&gt;</span>
    <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">responseData.xml</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">200</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="s">"Haha!"</span>
</pre></div>

<h3>
<a name="request" class="anchor" href="#request"><span class="octicon octicon-link"></span></a>request</h3>

<p>This object is used to match an incoming request to stubby against the available endpoints that have been configured.</p>

<h4>
<a name="url-required" class="anchor" href="#url-required"><span class="octicon octicon-link"></span></a>url (required)</h4>

<ul>
<li>is a full-fledged <strong>regular expression</strong>
</li>
<li>This is the only required property of an endpoint.</li>
<li>signify the url after the base host and port (i.e. after <code>localhost:8882</code>).</li>
<li>any query paramters are stripped (so don't include them, that's what <code>query</code> is for).

<ul>
<li>
<code>/url?some=value&amp;another=value</code> becomes <code>/url</code>
</li>
</ul>
</li>
<li>no checking is done for URI-encoding compliance.

<ul>
<li>If it's invalid, it won't ever trigger a match.</li>
</ul>
</li>
</ul><p>This is the simplest you can get:</p>

<div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/</span>
</pre></div>

<p>A demonstration using regular expressions:</p>

<div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/has/to/begin/with/this/</span>

<span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/has/to/end/with/this/$</span>

<span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/must/be/this/exactly/with/optional/trailing/slash/?$</span>

<span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/[a-z]{3}-[a-z]{3}/[0-9]{2}/[A-Z]{2}/[a-z0-9]+$</span>
</pre></div>

<h4>
<a name="method" class="anchor" href="#method"><span class="octicon octicon-link"></span></a>method</h4>

<ul>
<li>defaults to <code>GET</code>.</li>
<li>case-insensitive.</li>
<li>can be any of the following:

<ul>
<li>HEAD</li>
<li>GET</li>
<li>POST</li>
<li>PUT</li>
<li>POST</li>
<li>DELETE</li>
<li>etc.</li>
</ul>
</li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/anything</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">GET</span>
</pre></div>

<ul>
<li>it can also be an array of values.</li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/anything</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">GET</span><span class="p-Indicator">,</span> <span class="nv">HEAD</span><span class="p-Indicator">]</span>

<span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/anything</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">GET</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">HEAD</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">POST</span>
</pre></div>

<h4>
<a name="query" class="anchor" href="#query"><span class="octicon octicon-link"></span></a>query</h4>

<ul>
<li>values are full-fledged <strong>regular expressions</strong>
</li>
<li>if ommitted, stubby ignores query parameters for the given url.</li>
<li>a yaml hashmap of variable/value pairs.</li>
<li>allows the query parameters to appear in any order in a uri</li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span>  <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">GET</span>
      <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/with/parameters$</span>
      <span class="l-Scalar-Plain">query</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">type_name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">user</span>
         <span class="l-Scalar-Plain">client_id</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">id</span>
         <span class="l-Scalar-Plain">client_secret</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">secret</span>
         <span class="l-Scalar-Plain">random_id</span><span class="p-Indicator">:</span> <span class="s">"^sequence/-/\\d/"</span>
         <span class="l-Scalar-Plain">session_id</span><span class="p-Indicator">:</span> <span class="s">"^user_\\d{32}_local"</span>
</pre></div>

<ul>
<li>The following will match either of these:

<ul>
<li><code>/with/parameters?search=search+terms&amp;filter=month</code></li>
<li><code>/with/parameters?filter=month&amp;search=search+terms</code></li>
</ul>
</li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span>  <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/with/parameters$</span>
      <span class="l-Scalar-Plain">query</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">search</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">search terms</span>
         <span class="l-Scalar-Plain">filter</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">month</span>
</pre></div>

<h4>
<a name="post" class="anchor" href="#post"><span class="octicon octicon-link"></span></a>post</h4>

<ul>
<li>is a full-fledged <strong>regular expression</strong>
</li>
<li>if ommitted, any post data is ignored.</li>
<li>represents the body POST of incoming request, ie.: form data</li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/post/form/data$</span>
    <span class="l-Scalar-Plain">post</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">name=John&amp;email=john@example.com</span>
</pre></div>

<div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">POST</span><span class="p-Indicator">]</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/uri/with/post/regex</span>
    <span class="l-Scalar-Plain">post</span><span class="p-Indicator">:</span> <span class="s">"^[\\.,'a-zA-Z\\s+]*$"</span>
</pre></div>

<div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span>  <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/post/form/data$</span>
      <span class="l-Scalar-Plain">post</span><span class="p-Indicator">:</span> <span class="s">"^this/is/\\d/post/body"</span>
</pre></div>

<h4>
<a name="file" class="anchor" href="#file"><span class="octicon octicon-link"></span></a>file</h4>

<ul>
<li>holds a path to a local file (absolute or relative to the YAML specified in <code>-d</code> or <code>--data</code>)</li>
<li>if supplied, replaces <code>post</code> with the contents from the provided file

<ul>
<li>paths are relative from where the <code>--data</code> file is located</li>
</ul>
</li>
<li>if the local file could not be loaded for whatever reason (ie.: not found), stubby falls back to <code>post</code> for matching.</li>
<li>allows you to split up stubby data across multiple files instead of making one huge bloated main YAML</li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span>  <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/match/against/file$</span>
      <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">postedData.json</span>
      <span class="l-Scalar-Plain">post</span><span class="p-Indicator">:</span> <span class="s">'{"fallback":"data"}'</span>
</pre></div>

<p>postedData.json</p>

<div class="highlight highlight-json"><pre><span class="p">{</span><span class="nt">"fileContents"</span><span class="p">:</span><span class="s2">"match against this if the file is here"</span><span class="p">}</span>
</pre></div>

<ul>
<li>if <code>postedData.json</code> doesn't exist on the filesystem when <code>/match/against/file</code> is matched in incoming request, stubby will match post contents against <code>{"fallback":"data"}</code> (from <code>post</code>) instead.</li>
</ul><h4>
<a name="headers" class="anchor" href="#headers"><span class="octicon octicon-link"></span></a>headers</h4>

<ul>
<li>values are full-fledged <strong>regular expressions</strong>
</li>
<li>a hashmap of header/value pairs similar to <code>query</code>.</li>
<li>if ommitted, stubby ignores headers for the given url</li>
<li>if stubbed, stubby will try to match <strong>only</strong> the supplied headers and will ignore other headers of incoming request. In other words, the incoming request <strong>must</strong> contain stubbed header values</li>
<li>headers are case-insensitive during matching</li>
</ul><p>The following endpoint only accepts requests with <code>application/json</code> post values:</p>

<div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span>  <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/post/json</span>
      <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">post</span>
      <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
         <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
         <span class="l-Scalar-Plain">x-custom-header</span><span class="p-Indicator">:</span> <span class="s">"^this/is/</span><span class="err">\</span><span class="s">d/test"</span>
         <span class="l-Scalar-Plain">x-custom-header-2</span><span class="p-Indicator">:</span> <span class="s">"^[a-z]{4}_\\d{32}_(local|remote)"</span>
</pre></div>

<h3>
<a name="response" class="anchor" href="#response"><span class="octicon octicon-link"></span></a>response</h3>

<p>Assuming a match has been made against the given <code>request</code> object, data from <code>response</code> is used to build the stubbed response back to the client.</p>

<ul>
<li>Can be a single response or a sequence of responses</li>
<li>When sequenced responses are configured, upon each incoming request to the same URI a subsequent response in the list will be sent to the client. The sequenced responses play in a cycle </li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">GET</span><span class="p-Indicator">,</span><span class="nv">POST</span><span class="p-Indicator">]</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/invoice/123</span>

  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">201</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">OK</span>


<span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">GET</span><span class="p-Indicator">]</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/uri/with/sequenced/responses</span>

  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">201</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">OK</span>

  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">201</span>
      <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">content-stype</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="-Error">  </span><span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Still going strong!</span>

  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">500</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">OMG!!!</span>


<span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">GET</span><span class="p-Indicator">]</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/uri/with/sequenced/responses/infile</span>

  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">201</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">../json/sequenced.response.ok.json</span>

  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">201</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-stype</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">../json/sequenced.response.goingstrong.json</span>

  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">500</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">../json/sequenced.response.omfg.json</span>

<span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">GET</span><span class="p-Indicator">]</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/uri/with/single/sequenced/response</span>

  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">201</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-stype</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Still going strong!</span>
</pre></div>

<h4>
<a name="status" class="anchor" href="#status"><span class="octicon octicon-link"></span></a>status</h4>

<ul>
<li>the HTTP status code of the response.</li>
<li>integer or integer-like string.</li>
<li>defaults to <code>200</code>.</li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/im/a/teapot$</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">POST</span>
  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">420</span>
</pre></div>

<h4>
<a name="body" class="anchor" href="#body"><span class="octicon octicon-link"></span></a>body</h4>

<ul>
<li>contents of the response body</li>
<li>defaults to an empty content body</li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/give/me/a/smile$</span>
  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="s">':)'</span>
</pre></div>

<div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/give/me/a/smile$</span>

  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">200</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
      <span class="no">{"status": "hello world with single quote"}</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
</pre></div>

<div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">GET</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/atomfeed/1</span>

  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/xml</span>
    <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">200</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;payment&gt;&lt;paymentDetail&gt;&lt;invoiceTypeLookupCode/&gt;&lt;/paymentDetail&gt;&lt;/payment&gt;</span>
</pre></div>

<div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/1.1/direct_messages.json</span>
    <span class="l-Scalar-Plain">query</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">since_id</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">240136858829479935</span>
      <span class="l-Scalar-Plain">count</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">1</span>
  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">https://api.twitter.com/1.1/direct_messages.json?since_id=240136858829479935&amp;count=1</span>
</pre></div>

<h4>
<a name="file-1" class="anchor" href="#file-1"><span class="octicon octicon-link"></span></a>file</h4>

<ul>
<li>similar to <code>request.file</code>, but the contents of the file are used as the response <code>body</code>
</li>
<li>if the file could not be loaded, stubby falls back to the value stubbed in <code>body</code>
</li>
<li>if <code>body</code> was not stubbed, an empty string is returned by default</li>
<li>it can be an ASCII or binary file (PDF, images, etc.)</li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/</span>
  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">extremelyLongJsonFile.json</span>
</pre></div>

<h4>
<a name="headers-1" class="anchor" href="#headers-1"><span class="octicon octicon-link"></span></a>headers</h4>

<ul>
<li>similar to <code>request.headers</code> except that these are sent back to the client.</li>
<li>by default, the header <code>x-stubby-resource-id</code> containing the admin portal resource ID is returned with each stubbed response. The ID is useful if the returned resource needs to be updated at run time by ID via the admin portal</li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/give/me/some/json$</span>
  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">content-type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="p-Indicator">&gt;</span>
         <span class="no">[{</span>
            <span class="no">"name":"John",</span>
            <span class="no">"email":"john@example.com"</span>
         <span class="no">},{</span>
            <span class="no">"name":"Jane",</span>
            <span class="no">"email":"jane@example.com"</span>
         <span class="no">}]</span>
</pre></div>

<h4>
<a name="latency" class="anchor" href="#latency"><span class="octicon octicon-link"></span></a>latency</h4>

<ul>
<li>time to wait, in milliseconds, before sending back the response</li>
<li>good for testing timeouts, or slow connections</li>
</ul><div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/hello/to/jupiter$</span>
  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">latency</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">800000</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Hello, World!</span>
</pre></div>

<h2>
<a name="the-admin-portal" class="anchor" href="#the-admin-portal"><span class="octicon octicon-link"></span></a>The Admin Portal</h2>

<p>The admin portal is a RESTful(ish) endpoint running on <code>localhost:8889</code>. Or wherever you described through stubby's command line args.</p>

<h3>
<a name="supplying-endpoints-to-stubby" class="anchor" href="#supplying-endpoints-to-stubby"><span class="octicon octicon-link"></span></a>Supplying Endpoints to Stubby</h3>

<p>Submit <code>POST</code> requests to <code>localhost:8889</code> or load a data-file (using -d / --data flags) with the following structure for each endpoint:</p>

<ul>
<li>
<code>request</code>: describes the client's call to the server

<ul>
<li>
<code>method</code>: GET/POST/PUT/DELETE/etc.</li>
<li>
<code>url</code>: the URI regex string.</li>
<li>
<code>query</code>: a key/value map of query string parameters included with the request. Query param value can be regex.</li>
<li>
<code>headers</code>: a key/value map of headers the server should respond to. Header value can be regex.</li>
<li>
<code>post</code>: a string matching the textual body of the response. Post value can be regex.</li>
<li>
<code>file</code>: if specified, returns the contents of the given file as the request post. If the file cannot be found at request time, <strong>post</strong> is used instead</li>
</ul>
</li>
<li>
<code>response</code>: describes the server's response (or array of responses, refer to the examples) to the client

<ul>
<li>
<code>headers</code>: a key/value map of headers the server should use in it's response.</li>
<li>
<code>latency</code>: the time in milliseconds the server should wait before responding. Useful for testing timeouts and latency</li>
<li>
<code>file</code>: if specified, returns the contents of the given file as the response body. If the file cannot be found at request time, <strong>body</strong> is used instead</li>
<li>
<code>body</code>: the textual body of the server's response to the client</li>
<li>
<code>status</code>: the numerical HTTP status code (200 for OK, 404 for NOT FOUND, etc.)</li>
</ul>
</li>
</ul><h4>
<a name="yaml-file-only-or-postput" class="anchor" href="#yaml-file-only-or-postput"><span class="octicon octicon-link"></span></a>YAML (file only or POST/PUT)</h4>

<div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/path/to/something$</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">POST</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">authorization</span><span class="p-Indicator">:</span> <span class="s">"bob:password"</span>
      <span class="l-Scalar-Plain">x-custom-header</span><span class="p-Indicator">:</span> <span class="s">"^this/is/</span><span class="err">\</span><span class="s">d/test"</span>
    <span class="l-Scalar-Plain">post</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">this is some post data in textual format</span>
  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">Content-Type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">latency</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">1000</span>
    <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">200</span>
    <span class="l-Scalar-Plain">body</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">You're request was successfully processed!</span>

<span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/path/to/anotherThing</span>
    <span class="l-Scalar-Plain">query</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">a</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">anything</span>
      <span class="l-Scalar-Plain">b</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">more</span>
      <span class="l-Scalar-Plain">custom</span><span class="p-Indicator">:</span> <span class="s">"^this/is/</span><span class="err">\</span><span class="s">d/test"</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">GET</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">Content-Type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">post</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">Content-Type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
      <span class="l-Scalar-Plain">Access-Control-Allow-Origin</span><span class="p-Indicator">:</span> <span class="s">"*"</span>
    <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">204</span>
    <span class="l-Scalar-Plain">file</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">path/to/page.html</span>

<span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/path/to/thing$</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">POST</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">Content-Type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">post</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">this is some post data in textual format</span>
  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">headers</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">Content-Type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">application/json</span>
    <span class="l-Scalar-Plain">status</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">304</span>
</pre></div>

<h4>
<a name="json-file-or-postput" class="anchor" href="#json-file-or-postput"><span class="octicon octicon-link"></span></a>JSON (file or POST/PUT)</h4>

<div class="highlight highlight-json"><pre><span class="p">[</span>
  <span class="p">{</span>
    <span class="nt">"request"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"^/path/to/something$"</span><span class="p">,</span>
      <span class="nt">"post"</span><span class="p">:</span> <span class="s2">"this is some post data in textual format"</span><span class="p">,</span>
      <span class="nt">"headers"</span><span class="p">:</span> <span class="p">{</span>
         <span class="nt">"authorization"</span><span class="p">:</span> <span class="s2">"bob:password"</span>
      <span class="p">},</span>
      <span class="nt">"method"</span><span class="p">:</span> <span class="s2">"POST"</span>
    <span class="p">},</span>
    <span class="nt">"response"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"status"</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
      <span class="nt">"headers"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span>
      <span class="p">},</span>
      <span class="nt">"latency"</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
      <span class="nt">"body"</span><span class="p">:</span> <span class="s2">"You're request was successfully processed!"</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">"request"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"^/path/to/anotherThing"</span><span class="p">,</span>
      <span class="nt">"query"</span><span class="p">:</span> <span class="p">{</span>
         <span class="nt">"a"</span><span class="p">:</span> <span class="s2">"anything"</span><span class="p">,</span>
         <span class="nt">"b"</span><span class="p">:</span> <span class="s2">"more"</span>
      <span class="p">},</span>
      <span class="nt">"headers"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span>
      <span class="p">},</span>
      <span class="nt">"method"</span><span class="p">:</span> <span class="s2">"GET"</span>
    <span class="p">},</span>
    <span class="nt">"response"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"status"</span><span class="p">:</span> <span class="mi">204</span><span class="p">,</span>
      <span class="nt">"headers"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
        <span class="nt">"Access-Control-Allow-Origin"</span><span class="p">:</span> <span class="s2">"*"</span>
      <span class="p">},</span>
      <span class="nt">"file"</span><span class="p">:</span> <span class="s2">"path/to/page.html"</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">"request"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"url"</span><span class="p">:</span> <span class="s2">"^/path/to/thing$"</span><span class="p">,</span>
      <span class="nt">"headers"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span>
      <span class="p">},</span>
      <span class="nt">"post"</span><span class="p">:</span> <span class="s2">"this is some post data in textual format"</span><span class="p">,</span>
      <span class="nt">"method"</span><span class="p">:</span> <span class="s2">"POST"</span>
    <span class="p">},</span>
    <span class="nt">"response"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"status"</span><span class="p">:</span> <span class="mi">304</span><span class="p">,</span>
      <span class="nt">"headers"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>

<p>If you want to load more than one endpoint via file, use either a JSON array or YAML list (-) syntax. When creating or updating one stubbed request, the response will contain <code>Location</code> in the header with the newly created resources' location</p>

<h3>
<a name="getting-the-id-of-a-loaded-endpoint" class="anchor" href="#getting-the-id-of-a-loaded-endpoint"><span class="octicon octicon-link"></span></a>Getting the ID of a Loaded Endpoint</h3>

<p>Stubby adds the response-header <code>x-stubby-resource-id</code> to outgoing responses. This ID can be referenced for use with the Admin portal.</p>

<h3>
<a name="getting-the-current-list-of-stubbed-endpoints" class="anchor" href="#getting-the-current-list-of-stubbed-endpoints"><span class="octicon octicon-link"></span></a>Getting the Current List of Stubbed Endpoints</h3>

<p>Performing a <code>GET</code> request on <code>localhost:8889</code> will return a YAML list of all currently saved responses. It will reply with <code>204 : No Content</code> if there are none saved.</p>

<p>Performing a <code>GET</code> request on <code>localhost:8889/&lt;id&gt;</code> will return the YAML object representing the response with the supplied id.</p>

<h4>
<a name="the-status-page" class="anchor" href="#the-status-page"><span class="octicon octicon-link"></span></a>The Status Page</h4>

<p>You can also view the currently configured endpoints by going to <code>localhost:8889/status</code></p>

<h4>
<a name="the-refresh-stubbed-data-endpoint" class="anchor" href="#the-refresh-stubbed-data-endpoint"><span class="octicon octicon-link"></span></a>The Refresh Stubbed Data Endpoint</h4>

<p>If for some reason you do not want/cannot/not able to use <code>--watch</code> flag when starting stubby4j (or cannot restart),
you can submit <code>GET</code> request to <code>localhost:8889/refresh</code> (or load it in a browser) in order to refresh the stubbed data.</p>

<h3>
<a name="changing-existing-endpoints" class="anchor" href="#changing-existing-endpoints"><span class="octicon octicon-link"></span></a>Changing Existing Endpoints</h3>

<p>Perform <code>PUT</code> requests in the same format as using <code>POST</code>, only this time supply the id in the path. For instance, to update the response with id 4 you would <code>PUT</code> to <code>localhost:8889/4</code>.</p>

<h3>
<a name="deleting-endpoints" class="anchor" href="#deleting-endpoints"><span class="octicon octicon-link"></span></a>Deleting Endpoints</h3>

<p>Send a <code>DELETE</code> request to <code>localhost:8889/&lt;id&gt;</code></p>

<h2>
<a name="the-stubs-portal" class="anchor" href="#the-stubs-portal"><span class="octicon octicon-link"></span></a>The Stubs Portal</h2>

<p>Requests sent to any url at <code>localhost:8882</code> (or wherever you told stubby to run) will search through the available endpoints and, if a match is found, respond with that endpoint's <code>response</code> data</p>

<h3>
<a name="how-endpoints-are-matched" class="anchor" href="#how-endpoints-are-matched"><span class="octicon octicon-link"></span></a>How Endpoints Are Matched</h3>

<p>For a given endpoint, stubby only cares about matching the properties of the request that have been defined in the YAML. The exception to this rule is <code>method</code>; if it is omitted it is defaulted to <code>GET</code>.</p>

<p>For instance, the following will match any <code>POST</code> request to the root url:</p>

<div class="highlight highlight-yaml"><pre><span class="p-Indicator">-</span> <span class="l-Scalar-Plain">request</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/</span>
    <span class="l-Scalar-Plain">method</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">POST</span>
  <span class="l-Scalar-Plain">response</span><span class="p-Indicator">:</span> <span class="p-Indicator">{}</span>
</pre></div>

<p>The request could have any headers and any post body it wants. It will match the above.</p>

<p>Pseudocode:</p>

<pre><code>for each &lt;endpoint&gt; of stored endpoints {

   for each &lt;property&gt; of &lt;endpoint&gt; {
      if &lt;endpoint&gt;.&lt;property&gt; != &lt;incoming request&gt;.&lt;property&gt;
         next endpoint
   }

   return &lt;endpoint&gt;
}
</code></pre>

<h2>
<a name="programmatic-apis" class="anchor" href="#programmatic-apis"><span class="octicon octicon-link"></span></a>Programmatic APIs</h2>

<p>Since programming languages vary, please refer to the individual project pages for their respective programmatic interfaces.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Stub.by maintained by <a href="https://github.com/mrak">mrak</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
